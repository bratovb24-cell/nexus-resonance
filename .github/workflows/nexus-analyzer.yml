name: NEXUS Analyzer Agents (Phase 3)

on:
  schedule:
    # –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –∫–∞–∂–¥—ã–µ 5)
    - cron: '*/30 * * * *'
  workflow_dispatch:
    inputs:
      num_agents:
        description: 'Number of analyzer agents to run'
        required: false
        default: '8'

env:
  PYTHONUNBUFFERED: 1
  PYTHONIOENCODING: utf-8

jobs:
  analyze:
    name: Run Analyzer Agents
    runs-on: ubuntu-latest

    permissions:
      contents: read
      issues: write
      pull-requests: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Python 3.11
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: Install dependencies
        run: |
          pip install requests pyyaml

      - name: Run Analyzer Agents
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          NUM_AGENTS: ${{ inputs.num_agents || '8' }}
        run: |
          echo "üß¨ NEXUS Phase 3: Starting Analyzer Agents..."
          echo "================================================"
          python3 nexus_agents/analyzer.py
          echo "================================================"
          echo "‚úÖ Analysis cycle completed!"

      - name: Log completion
        if: always()
        run: |
          echo "üìä Analyzer Agents completed at $(date)"
          echo "Next run scheduled in 30 minutes"
